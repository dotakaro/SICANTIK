# DOCKER ENVIRONMENT PLAN
# SICANTIK Companion App Development Environment

## CONTAINER ARCHITECTURE

### Service Overview
```
┌─────────────────────────────────────────────────────────┐
│                 HOST MACHINE                            │
├─────────────────────────────────────────────────────────┤
│  SICANTIK Existing (Running Separately)                │
│  ├── Apache/Nginx (port 80)                            │
│  ├── MySQL Database (port 3306)                        │
│  └── PHP Application                                    │
├─────────────────────────────────────────────────────────┤
│  SICANTIK Companion (Docker Compose)                   │
│  ├── Odoo 18 Enterprise (port 8018)                    │
│  ├── PostgreSQL (port 5433)                            │
│  ├── MinIO Document Storage (port 9000)                │
│  ├── Redis Cache (port 6380)                           │
│  ├── BSRE Connector Service (port 8020)                │
│  └── Nginx Reverse Proxy (port 8080)                   │
└─────────────────────────────────────────────────────────┘
```

### Port Mapping Strategy
- 8018: Odoo Companion App
- 5433: PostgreSQL (avoid conflict with default 5432)
- 9000: MinIO Console
- 9001: MinIO API
- 6380: Redis (avoid conflict with default 6379)
- 8020: BSRE Connector Service
- 8080: Nginx Reverse Proxy

## DOCKER COMPOSE STRUCTURE

### Main Services
1. **odoo_companion**: Odoo 18 Enterprise with custom addons
2. **postgres_companion**: PostgreSQL 15 for Odoo data
3. **minio_documents**: MinIO for PDF document storage
4. **redis_cache**: Redis for caching and session management
5. **bsre_connector**: Custom service for BSRE API integration
6. **nginx_proxy**: Reverse proxy for load balancing

### Volume Strategy
- **odoo_data**: Odoo application data and addons
- **postgres_data**: PostgreSQL database files
- **minio_data**: Document storage files
- **sicantik_pdfs**: Mounted from SICANTIK upload directory (read-only)

### Network Configuration
- **sicantik_network**: Custom bridge network for all services
- **external_network**: For connecting to external SICANTIK MySQL

## DEVELOPMENT WORKFLOW

### Initial Setup
1. Clone repository and setup directory structure
2. Configure environment variables
3. Build custom Docker images
4. Initialize databases and connections
5. Deploy Odoo custom modules

### Daily Development
1. Start environment: `docker-compose up -d`
2. Access Odoo: `http://localhost:8018`
3. Monitor logs: `docker-compose logs -f`
4. Stop environment: `docker-compose down`

### Database Integration
- MySQL connection to existing SICANTIK (read-only)
- PostgreSQL for Odoo application data
- Automated data synchronization jobs
- Connection pooling for performance

## SECURITY CONSIDERATIONS

### Access Control
- Read-only MySQL user for SICANTIK database
- Encrypted connections between services
- API rate limiting for public endpoints
- File system permissions for document access

### Data Protection
- Encrypted storage for signed documents
- Backup strategy for critical data
- Audit logging for all operations
- GDPR compliance for personal data

## MONITORING & MAINTENANCE

### Health Checks
- Database connection monitoring
- Service availability checks
- Performance metrics collection
- Error logging and alerting

### Backup Strategy
- Daily automated backups
- Document repository backup
- Database dump scheduling
- Disaster recovery procedures
